<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Create Packing Template</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        label { display: block; margin: 5px 0; }
        input { margin-left: 10px; }
        button { margin-top: 10px; padding: 8px 14px; cursor: pointer; }
        pre { background: #f4f4f4; padding: 10px; border-radius: 6px; }
        .item-row { margin-bottom: 8px; }
    </style>
    <script>
        function addItemRow() {
          const container = document.getElementById("itemsContainer");

          const div = document.createElement("div");
          div.className = "item-row";
          div.innerHTML = `
            <label>
              Item Name: <input class="itemName" required>
              Quantity per Person: <input class="qty" type="number" value="1" required style="width:60px;">
              <button type="button" onclick="this.parentElement.parentElement.remove()">Remove</button>
            </label>
          `;
          container.appendChild(div);
        }

        async function createTemplate() {
          const name = document.getElementById("name").value;
          const description = document.getElementById("description").value;

          const itemNames = document.querySelectorAll(".itemName");
          const qtys = document.querySelectorAll(".qty");

          const items = [];
          for (let i = 0; i < itemNames.length; i++) {
            items.push({
              name: itemNames[i].value,
              qtyPerPerson: parseInt(qtys[i].value, 10),
              notes: ""
            });
          }

          const payload = { name, description, items };

          const resp = await fetch("/tripplanner/packing-templates", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
          });

          const data = await resp.json();
          document.getElementById("result").textContent =
            JSON.stringify(data, null, 2);
        }
    </script>
</head>
<body>
<h1>Create Packing Template</h1>
<form onsubmit="event.preventDefault(); createTemplate();">
    <label>Template Name: <input id="name" required></label>
    <label>Description: <input id="description"></label>

    <h3>Items</h3>
    <div id="itemsContainer"></div>
    <button type="button" onclick="addItemRow()">+ Add Item</button><br><br>

    <button type="submit">Create Template</button>
</form>

<h2>Response</h2>
<pre id="result"></pre>

<button onclick="window.location.href='templates.html'">‚Üê Back to Templates List</button>

<script>
    // add one row by default
    addItemRow();
</script>
</body>
</html>
